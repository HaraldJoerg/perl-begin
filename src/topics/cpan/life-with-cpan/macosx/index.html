<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html><html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>NovoSial.org: CPAN on Mac OS X</title>
<meta name="keywords" content="sial.org, unix, openssl, ssh"/>
<meta name="msvalidate.01" content="4D4AA5634CCCC8B90DD61AC8A12D742B" />
<meta charset="UTF-8" />
<meta name="generator" content="XML::ApplyXSLT, libxml, and Perl"/>
<link rel="stylesheet" type="text/css" href="../default.css"/><meta name="MSSmartTagsPreventParsing" content="TRUE"/>


</head>
<body>

    <div class="header"><h1>CPAN on Mac OS X</h1></div>

    <div class='mainBody'>
      <div class="subsection"><a href="#s2">Upgrade System Perl?</a> | <a href="#s3">Case Folding Filesystem</a> | <a href="#s4">Panther (10.3) and <code class="file">/man</code></a></div><div class="bodymain"><p class="info">The <a href="http://www.cpan.org/">Comprehensive Perl Archive Network (CPAN)</a> is a collection of <a href="http://www.perl.org/">Perl</a> modules and scripts distributed among a large number of mirror sites.  <a href="http://search.cpan.org/perldoc/CPAN" title="Documentation on the CPAN Perl module"><code class="perl-module">CPAN</code></a> is also the name of a <code class="cmd">perl</code> module which provides an interface to install modules from <abbr title="Comprehensive Perl Archive Network">CPAN</abbr>. These notes document problems with <a href="http://search.cpan.org/perldoc/CPAN" title="Documentation on the CPAN Perl module"><code class="perl-module">CPAN</code></a> on <a href="http://www.apple.com/macosx/">Mac OS X</a>. See also the main <a href="../index.html">Life with <abbr title="Comprehensive Perl Archive Network">CPAN</abbr></a> documentation.</p><p class="info">Xcode (via <a href="http://developer.apple.com/technologies/tools/">Developer Tools</a> must be installed (installing Xcode also installs the <a href="http://novosial.org/perl/perldoc/">Perl documentation</a> on Mac OS X). Another option is to run another Unix, such as <a href="http://www.debian.org/">Debian</a>, under a <a href="http://www.virtualbox.org/">virtual machine</a>, and install whatever modules are required for development into the sandbox system.</p><h2 id="s2">Upgrade System Perl?</h2><p class="info">I advise against upgrading the system <code class="cmd">perl</code>, and against installing Perl modules into the system <code class="code">@INC</code> directories. If a different version of <code class="cmd">perl</code> is required, install it from <a href="http://www.macports.org/">MacPorts</a> (<a href="http://search.cpan.org/perldoc/App::perlbrew" title="Documentation on the App::perlbrew Perl module"><code class="perl-module">App::perlbrew</code></a> is another option, though does not support the installation of C libraries like MacPorts does). Changing the system <code class="cmd">perl</code> may break any scripts that rely on a particular version of software installed; Apple updates could also break the <code class="cmd">perl</code> or new modules improperly installed into the system area. Keep the vendor space separate from any local or site changes where possible. Administrative access is not necessary to install modules, as these can be <a href="../non-root/index.html">installed into local directories</a> via <a href="http://search.cpan.org/perldoc/local::lib" title="Documentation on the local::lib Perl module"><code class="perl-module">local::lib</code></a>. An administrator would need to install Xcode, if that is not available. <a href="http://novosial.org/perl/life-with-cpan/depot/">Perl Software Depots</a> goes into more detail on the management of software installs.</p><p class="info">As of Mac OS X 10.6, the OS ships with multiple versions of <code class="cmd">perl</code> installed. Peruse the <a href="http://www.FreeBSD.org/cgi/man.cgi?query=perl&amp;sektion=1" title="FreeBSD man page search for perl, section 1"><code class="man">perl(1)</code></a> manual page on Mac OS X for more details on how to switch between the two, if necessary.</p><p class="data-shell">$ <kbd>sw_vers</kbd><br/>ProductName:	Mac OS X<br/>ProductVersion:	10.6.3<br/>BuildVersion:	10D573<br/>$ <kbd>perl -e 'system "ls $_/perl5*" for split /:/, $ENV{PATH}' 2&gt;/dev/null</kbd><br/>/usr/bin/perl5.10.0	/usr/bin/perl5.8.9</p><p class="info">If a custom version of Perl is installed, either the <code class="code">PATH</code> environment variable must list that <code class="cmd">perl</code> first, or the shebang line must be updated to always use the custom <code class="cmd">perl</code>. I strongly advise against using symlinks to overwrite vendor versions of <code class="cmd">perl</code>, as this again could cause unexpected problems should Apple release a patch that changes something; also, <code class="cmd">perl</code> is just one of many commands associated with Perl, so a symlink of just <code class="file">/opt/local/bin/perl</code> to <code class="file">/usr/bin/perl</code> will still cause <code class="file">/usr/bin/cpan</code> to be used, resulting in modules installed for who knows what Perl.</p><p class="data-shell">$ <kbd>which perl</kbd><br/>/opt/local/bin/perl<br/>$ <kbd>type -a perl</kbd><br/>perl is /opt/local/bin/perl<br/>perl is /usr/bin/perl<br/>$ <kbd>head -1 ~/bin/xmltidy</kbd><br/>#!/opt/local/bin/perl</p><p class="info">Consult the documentation for the shell used on how to configure the <code class="code">PATH</code> environment variable. Note that the <code class="code">PATH</code> and other environment variables may need to be set in the <code class="file">environment.plist</code> file for non-terminal programs such as <code class="gui">BBEdit</code>.</p><h2 id="s3">Case Folding Filesystem</h2><p class="info">The default filesystem on Mac OS X (HFS+) folds case, unlike traditional Unix filesystems. Unix software that assumes <code class="file">HEAD</code> and <code class="file">head</code> are two different things on Mac OS X will end badly. For example, the <a href="http://search.cpan.org/perldoc/LWP::UserAgent" title="Documentation on the LWP::UserAgent Perl module"><code class="perl-module">LWP::UserAgent</code></a> module installs <code class="file">/usr/bin/HEAD</code>, which clobbers the existing <code class="file">/usr/bin/head</code> utility.  Solutions to this include not installing the <code class="cmd">HEAD</code> and similar shortcuts, or ensuring these utilities are installed under <code class="file">/usr/local/bin</code> instead.  One way is to update the <code class="code">perl Makefile.PL</code> arguments to install third-party utilities into a different directory than <code class="file">/usr/bin</code>.</p><p class="data-shell">cpan&gt; <kbd>o conf makepl_arg "INSTALLBIN=/usr/local/bin INSTALLSCRIPT=/usr/local/bin"</kbd><br/>cpan&gt; <kbd>o conf commit</kbd></p><p class="info">Due to the rise in popularity of Mac OS X, most of these issues have been worked around in popular modules, such as <a href="http://search.cpan.org/perldoc/LWP::UserAgent" title="Documentation on the LWP::UserAgent Perl module"><code class="perl-module">LWP::UserAgent</code></a>. However, older, or less frequently used modules may still contain code that assumes filesystem case sensitivity.</p><h2 id="s4">Panther (10.3) and <code class="file">/man</code></h2><p class="info">Perl 5.8.1 on Mac OS X 10.3 shipped with broken settings that cause some modules installed from <abbr title="Comprehensive Perl Archive Network">CPAN</abbr> to install their manuals under the <code class="file">/man</code> directory.  This directory pollutes the root namespace, and is outside the places manuals are searched for by <a href="http://www.FreeBSD.org/cgi/man.cgi?query=man&amp;sektion=1" title="FreeBSD man page search for man, section 1"><code class="man">man(1)</code></a>.</p><p class="info">To fix this problem, update the <code class="code">makepl_arg</code> to set <code class="code">INSTALLSITEMAN1DIR</code> and <code class="code">INSTALLSITEMAN3DIR</code> manually.</p><p class="data-shell">$ <kbd>grep makepl_arg /System/Library/Perl/5.8.1/CPAN/Config.pm</kbd><br/>  'makepl_arg' =&gt; q[INSTALLSITEMAN1DIR=/usr/share/man/man1 <span class="rbr">?</span><br/>INSTALLSITEMAN3DIR=/usr/share/man/man3],</p></div>
    </div>

		<div class="footer"><a href="../index.html"><img style="border: 0; float: right; margin-top: 1em; margin-right: 1em; margin-bottom: 5em" src="http://novosial.org/NovosialLogo.gif" width="64" height="64" alt="NovoSial Icon"/></a>
<p>This document is released into the public domain. Version 1.3.</p></div>
  </body>
</html>
